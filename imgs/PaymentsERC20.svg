<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: UmlClassDiagram Pages: 1 -->
<svg width="2458pt" height="1701pt"
 viewBox="0.00 0.00 2457.98 1700.60" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1696.6)">
<title>UmlClassDiagram</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1696.6 2453.9787,-1696.6 2453.9787,4 -4,4"/>
<!-- 1 -->
<g id="node1" class="node">
<title>1</title>
<polygon fill="#f2f2f2" stroke="#000000" points="173.7072,-386.9 173.7072,-478.1 433.1042,-478.1 433.1042,-386.9 173.7072,-386.9"/>
<text text-anchor="middle" x="303.4057" y="-461.5" font-family="Times,serif" font-size="14.00" fill="#000000">MyToken</text>
<polyline fill="none" stroke="#000000" points="173.7072,-453.3 433.1042,-453.3 "/>
<text text-anchor="middle" x="303.4057" y="-436.7" font-family="Times,serif" font-size="14.00" fill="#000000"> </text>
<polyline fill="none" stroke="#000000" points="173.7072,-428.5 433.1042,-428.5 "/>
<text text-anchor="start" x="181.7072" y="-411.9" font-family="Times,serif" font-size="14.00" fill="#000000">Public:</text>
<text text-anchor="start" x="181.7072" y="-395.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;constructor(name: string, symbol: string)</text>
</g>
<!-- 0 -->
<g id="node2" class="node">
<title>0</title>
<polygon fill="#f2f2f2" stroke="#000000" points="451.0077,-361.7 451.0077,-503.3 675.8037,-503.3 675.8037,-361.7 451.0077,-361.7"/>
<text text-anchor="middle" x="563.4057" y="-486.7" font-family="Times,serif" font-size="14.00" fill="#000000">Migrations</text>
<polyline fill="none" stroke="#000000" points="451.0077,-478.5 675.8037,-478.5 "/>
<text text-anchor="start" x="459.0077" y="-461.9" font-family="Times,serif" font-size="14.00" fill="#000000">Public:</text>
<text text-anchor="start" x="459.0077" y="-445.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;owner: address</text>
<text text-anchor="start" x="459.0077" y="-428.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;last_completed_migration: uint256</text>
<polyline fill="none" stroke="#000000" points="451.0077,-420.1 675.8037,-420.1 "/>
<text text-anchor="start" x="459.0077" y="-403.5" font-family="Times,serif" font-size="14.00" fill="#000000">Public:</text>
<text text-anchor="start" x="459.0077" y="-386.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;modifier&gt;&gt; restricted()</text>
<text text-anchor="start" x="459.0077" y="-369.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;setCompleted(completed: uint256)</text>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<polygon fill="#f2f2f2" stroke="#000000" points="1310.7302,-353.3 1310.7302,-511.7 1916.0812,-511.7 1916.0812,-353.3 1310.7302,-353.3"/>
<text text-anchor="middle" x="1613.4057" y="-495.1" font-family="Times,serif" font-size="14.00" fill="#000000">EIP712Verifier</text>
<polyline fill="none" stroke="#000000" points="1310.7302,-486.9 1916.0812,-486.9 "/>
<text text-anchor="start" x="1318.7302" y="-470.3" font-family="Times,serif" font-size="14.00" fill="#000000">Private:</text>
<text text-anchor="start" x="1318.7302" y="-453.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;_TYPEHASH_PAYMENT: bytes32</text>
<text text-anchor="start" x="1318.7302" y="-436.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;_TYPEHASH_ASSETTRANSFER: bytes32</text>
<polyline fill="none" stroke="#000000" points="1310.7302,-428.5 1916.0812,-428.5 "/>
<text text-anchor="start" x="1318.7302" y="-411.9" font-family="Times,serif" font-size="14.00" fill="#000000">Public:</text>
<text text-anchor="start" x="1318.7302" y="-395.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;constructor()</text>
<text text-anchor="start" x="1318.7302" y="-378.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;verifyPayment(payInput: PaymentInput, signature: bytes, signer: address): bool</text>
<text text-anchor="start" x="1318.7302" y="-361.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;verifyAssetTransferResult(transferResult: AssetTransferResult, signature: bytes, signer: address): bool</text>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<polygon fill="#f2f2f2" stroke="#000000" points="1219.9802,-1170.3 1219.9802,-1295.1 1828.8312,-1295.1 1828.8312,-1170.3 1219.9802,-1170.3"/>
<text text-anchor="middle" x="1524.4057" y="-1278.5" font-family="Times,serif" font-size="14.00" fill="#000000">&lt;&lt;Interface&gt;&gt;</text>
<text text-anchor="middle" x="1524.4057" y="-1261.7" font-family="Times,serif" font-size="14.00" fill="#000000">IEIP712Verifier</text>
<polyline fill="none" stroke="#000000" points="1219.9802,-1253.5 1828.8312,-1253.5 "/>
<text text-anchor="middle" x="1524.4057" y="-1236.9" font-family="Times,serif" font-size="14.00" fill="#000000"> </text>
<polyline fill="none" stroke="#000000" points="1219.9802,-1228.7 1828.8312,-1228.7 "/>
<text text-anchor="start" x="1227.9802" y="-1212.1" font-family="Times,serif" font-size="14.00" fill="#000000">External:</text>
<text text-anchor="start" x="1227.9802" y="-1195.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;verifyPayment(payInput: PaymentInput, signature: bytes, signer: address): bool</text>
<text text-anchor="start" x="1227.9802" y="-1178.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;verifyAssetTransferResult(transferResult: AssetTransferResult, signature: bytes, signer: address): bool</text>
</g>
<!-- 2&#45;&gt;4 -->
<g id="edge5" class="edge">
<title>2&#45;&gt;4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1604.5876,-511.7836C1588.0147,-660.7906 1552.3055,-981.8527 1534.6779,-1140.3421"/>
<polygon fill="none" stroke="#000000" points="1524.2351,-1139.2472 1531.3544,-1170.2241 1545.1064,-1141.5687 1524.2351,-1139.2472"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<polygon fill="#f2f2f2" stroke="#000000" points="293.7731,-1103.1 293.7731,-1362.3 767.0383,-1362.3 767.0383,-1103.1 293.7731,-1103.1"/>
<text text-anchor="middle" x="530.4057" y="-1345.7" font-family="Times,serif" font-size="14.00" fill="#000000">FeesCollectors</text>
<polyline fill="none" stroke="#000000" points="293.7731,-1337.5 767.0383,-1337.5 "/>
<text text-anchor="start" x="301.7731" y="-1320.9" font-family="Times,serif" font-size="14.00" fill="#000000">Private:</text>
<text text-anchor="start" x="301.7731" y="-1304.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;_defaultFeesCollector: address</text>
<text text-anchor="start" x="301.7731" y="-1287.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;_universeFeesCollectors: mapping(uint256=&gt;address)</text>
<polyline fill="none" stroke="#000000" points="293.7731,-1279.1 767.0383,-1279.1 "/>
<text text-anchor="start" x="301.7731" y="-1262.5" font-family="Times,serif" font-size="14.00" fill="#000000">External:</text>
<text text-anchor="start" x="301.7731" y="-1245.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;setDefaultFeesCollector(feesCollector: address)</text>
<text text-anchor="start" x="301.7731" y="-1228.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;setUniverseFeesCollector(universeId: uint256, feesCollector: address)</text>
<text text-anchor="start" x="301.7731" y="-1212.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;removeUniverseFeesCollector(universeId: uint256)</text>
<text text-anchor="start" x="301.7731" y="-1195.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;defaultFeesCollector(): address</text>
<text text-anchor="start" x="301.7731" y="-1178.5" font-family="Times,serif" font-size="14.00" fill="#000000">Public:</text>
<text text-anchor="start" x="301.7731" y="-1161.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; DefaultFeesCollector(feesCollector: address)</text>
<text text-anchor="start" x="301.7731" y="-1144.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; UniverseFeesCollector(universeId: uint256, feesCollector: address)</text>
<text text-anchor="start" x="301.7731" y="-1128.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;constructor()</text>
<text text-anchor="start" x="301.7731" y="-1111.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;universeFeesCollector(universeId: uint256): address</text>
</g>
<!-- 6 -->
<g id="node9" class="node">
<title>6</title>
<polygon fill="#f2f2f2" stroke="#000000" points="813.1371,-1600.9 813.1371,-1692.1 921.6743,-1692.1 921.6743,-1600.9 813.1371,-1600.9"/>
<text text-anchor="middle" x="867.4057" y="-1675.5" font-family="Times,serif" font-size="14.00" fill="#000000">&lt;&lt;Interface&gt;&gt;</text>
<text text-anchor="middle" x="867.4057" y="-1658.7" font-family="Times,serif" font-size="14.00" fill="#000000">ISignableStructs</text>
<polyline fill="none" stroke="#000000" points="813.1371,-1650.5 921.6743,-1650.5 "/>
<text text-anchor="middle" x="867.4057" y="-1633.9" font-family="Times,serif" font-size="14.00" fill="#000000"> </text>
<polyline fill="none" stroke="#000000" points="813.1371,-1625.7 921.6743,-1625.7 "/>
<text text-anchor="middle" x="867.4057" y="-1609.1" font-family="Times,serif" font-size="14.00" fill="#000000"> </text>
</g>
<!-- 4&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>4&#45;&gt;6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1482.799,-1295.371C1429.185,-1371.0225 1328.7815,-1496.5173 1211.4057,-1564.4 1130.729,-1611.0583 1024.7868,-1631.2499 951.9025,-1639.9572"/>
<polygon fill="none" stroke="#000000" points="950.6415,-1629.5318 921.9065,-1643.1168 952.8415,-1650.4163 950.6415,-1629.5318"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<polygon fill="#f2f2f2" stroke="#000000" points="1846.8327,-901.5 1846.8327,-1563.9 2449.9787,-1563.9 2449.9787,-901.5 1846.8327,-901.5"/>
<text text-anchor="middle" x="2148.4057" y="-1547.3" font-family="Times,serif" font-size="14.00" fill="#000000">&lt;&lt;Interface&gt;&gt;</text>
<text text-anchor="middle" x="2148.4057" y="-1530.5" font-family="Times,serif" font-size="14.00" fill="#000000">IPaymentsERC20</text>
<polyline fill="none" stroke="#000000" points="1846.8327,-1522.3 2449.9787,-1522.3 "/>
<text text-anchor="middle" x="2148.4057" y="-1505.7" font-family="Times,serif" font-size="14.00" fill="#000000"> </text>
<polyline fill="none" stroke="#000000" points="1846.8327,-1497.5 2449.9787,-1497.5 "/>
<text text-anchor="start" x="1854.8327" y="-1480.9" font-family="Times,serif" font-size="14.00" fill="#000000">External:</text>
<text text-anchor="start" x="1854.8327" y="-1464.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;registerAsSeller()</text>
<text text-anchor="start" x="1854.8327" y="-1447.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;relayedPay(payInput: PaymentInput, buyerSignature: bytes)</text>
<text text-anchor="start" x="1854.8327" y="-1430.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;pay(payInput: PaymentInput, operatorSignature: bytes)</text>
<text text-anchor="start" x="1854.8327" y="-1413.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;finalize(transferResult: AssetTransferResult, operatorSignature: bytes)</text>
<text text-anchor="start" x="1854.8327" y="-1396.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;finalizeAndWithdraw(transferResult: AssetTransferResult, operatorSignature: bytes)</text>
<text text-anchor="start" x="1854.8327" y="-1380.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;refund(paymentId: bytes32)</text>
<text text-anchor="start" x="1854.8327" y="-1363.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;refundAndWithdraw(paymentId: bytes32)</text>
<text text-anchor="start" x="1854.8327" y="-1346.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;withdraw()</text>
<text text-anchor="start" x="1854.8327" y="-1329.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;withdrawAmount(amount: uint256)</text>
<text text-anchor="start" x="1854.8327" y="-1312.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;isSellerRegistrationRequired(): bool</text>
<text text-anchor="start" x="1854.8327" y="-1296.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;isRegisteredSeller(addr: address): bool</text>
<text text-anchor="start" x="1854.8327" y="-1279.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;erc20(): address</text>
<text text-anchor="start" x="1854.8327" y="-1262.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;balanceOf(addr: address): uint256</text>
<text text-anchor="start" x="1854.8327" y="-1245.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;erc20BalanceOf(addr: address): uint256</text>
<text text-anchor="start" x="1854.8327" y="-1228.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;allowance(buyer: address): uint256</text>
<text text-anchor="start" x="1854.8327" y="-1212.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;paymentInfo(paymentId: bytes32): Payment</text>
<text text-anchor="start" x="1854.8327" y="-1195.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;paymentState(paymentId: bytes32): State</text>
<text text-anchor="start" x="1854.8327" y="-1178.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;acceptsRefunds(paymentId: bytes32): bool</text>
<text text-anchor="start" x="1854.8327" y="-1161.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;EIP712Address(): address</text>
<text text-anchor="start" x="1854.8327" y="-1144.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;paymentWindow(): uint256</text>
<text text-anchor="start" x="1854.8327" y="-1128.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;acceptedCurrency(): string</text>
<text text-anchor="start" x="1854.8327" y="-1111.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;enoughFundsAvailable(buyer: address, amount: uint256): bool</text>
<text text-anchor="start" x="1854.8327" y="-1094.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;maxFundsAvailable(buyer: address): uint256</text>
<text text-anchor="start" x="1854.8327" y="-1077.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;splitFundingSources(buyer: address, amount: uint256): (externalFunds: uint256, localFunds: uint256)</text>
<text text-anchor="start" x="1854.8327" y="-1060.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;checkPaymentInputs(payInput: PaymentInput)</text>
<text text-anchor="start" x="1854.8327" y="-1044.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;computeFeeAmount(amount: uint256, feeBPS: uint256): uint256</text>
<text text-anchor="start" x="1854.8327" y="-1027.3" font-family="Times,serif" font-size="14.00" fill="#000000">Public:</text>
<text text-anchor="start" x="1854.8327" y="-1010.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; EIP712(eip712address: address)</text>
<text text-anchor="start" x="1854.8327" y="-993.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; PaymentWindow(window: uint256)</text>
<text text-anchor="start" x="1854.8327" y="-976.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; NewSeller(seller: address)</text>
<text text-anchor="start" x="1854.8327" y="-960.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; BuyerRefunded(paymentId: bytes32, buyer: address)</text>
<text text-anchor="start" x="1854.8327" y="-943.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; PayIn(paymentId: bytes32, buyer: address, seller: address)</text>
<text text-anchor="start" x="1854.8327" y="-926.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; Paid(paymentId: bytes32)</text>
<text text-anchor="start" x="1854.8327" y="-909.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; Withdraw(user: address, amount: uint256)</text>
</g>
<!-- 5&#45;&gt;6 -->
<g id="edge7" class="edge">
<title>5&#45;&gt;6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1846.6839,-1559.7496C1843.6068,-1561.3438 1840.514,-1562.8946 1837.4057,-1564.4 1758.7516,-1602.4929 1173.9617,-1632.6263 952.2718,-1642.7945"/>
<polygon fill="none" stroke="#000000" points="951.5008,-1632.3185 922.0052,-1644.1616 952.4485,-1653.2971 951.5008,-1632.3185"/>
</g>
<!-- 5struct0 -->
<g id="node7" class="node">
<title>5struct0</title>
<polygon fill="#f2f2f2" stroke="#000000" points="2157.1648,-340.5 2157.1648,-524.5 2309.6466,-524.5 2309.6466,-340.5 2157.1648,-340.5"/>
<text text-anchor="middle" x="2233.4057" y="-507.9" font-family="Times,serif" font-size="14.00" fill="#000000">&lt;&lt;struct&gt;&gt;</text>
<text text-anchor="middle" x="2233.4057" y="-491.1" font-family="Times,serif" font-size="14.00" fill="#000000">Payment</text>
<polyline fill="none" stroke="#000000" points="2157.1648,-482.9 2309.6466,-482.9 "/>
<text text-anchor="start" x="2165.1648" y="-466.3" font-family="Times,serif" font-size="14.00" fill="#000000">state: State</text>
<text text-anchor="start" x="2165.1648" y="-449.5" font-family="Times,serif" font-size="14.00" fill="#000000">buyer: address</text>
<text text-anchor="start" x="2165.1648" y="-432.7" font-family="Times,serif" font-size="14.00" fill="#000000">seller: address</text>
<text text-anchor="start" x="2165.1648" y="-415.9" font-family="Times,serif" font-size="14.00" fill="#000000">operator: address</text>
<text text-anchor="start" x="2165.1648" y="-399.1" font-family="Times,serif" font-size="14.00" fill="#000000">feesCollector: address</text>
<text text-anchor="start" x="2165.1648" y="-382.3" font-family="Times,serif" font-size="14.00" fill="#000000">expirationTime: uint256</text>
<text text-anchor="start" x="2165.1648" y="-365.5" font-family="Times,serif" font-size="14.00" fill="#000000">feeBPS: uint256</text>
<text text-anchor="start" x="2165.1648" y="-348.7" font-family="Times,serif" font-size="14.00" fill="#000000">amount: uint256</text>
</g>
<!-- 5struct0&#45;&gt;5 -->
<g id="edge1" class="edge">
<title>5struct0&#45;&gt;5</title>
<path fill="none" stroke="#000000" d="M2223.6136,-524.6836C2214.0899,-614.3414 2199.0272,-756.143 2184.8751,-889.3724"/>
<polygon fill="#000000" stroke="#000000" points="2184.8641,-889.4774 2188.2079,-895.8664 2183.5964,-901.4103 2180.2526,-895.0213 2184.8641,-889.4774"/>
</g>
<!-- 5enum0 -->
<g id="node8" class="node">
<title>5enum0</title>
<polygon fill="#f2f2f2" stroke="#000000" points="2007.6802,-374.1 2007.6802,-490.9 2139.1312,-490.9 2139.1312,-374.1 2007.6802,-374.1"/>
<text text-anchor="middle" x="2073.4057" y="-474.3" font-family="Times,serif" font-size="14.00" fill="#000000">&lt;&lt;enum&gt;&gt;</text>
<text text-anchor="middle" x="2073.4057" y="-457.5" font-family="Times,serif" font-size="14.00" fill="#000000">State</text>
<polyline fill="none" stroke="#000000" points="2007.6802,-449.3 2139.1312,-449.3 "/>
<text text-anchor="start" x="2015.6802" y="-432.7" font-family="Times,serif" font-size="14.00" fill="#000000">NotStarted: 0</text>
<text text-anchor="start" x="2015.6802" y="-415.9" font-family="Times,serif" font-size="14.00" fill="#000000">AssetTransferring: 1</text>
<text text-anchor="start" x="2015.6802" y="-399.1" font-family="Times,serif" font-size="14.00" fill="#000000">Refunded: 2</text>
<text text-anchor="start" x="2015.6802" y="-382.3" font-family="Times,serif" font-size="14.00" fill="#000000">Paid: 3</text>
</g>
<!-- 5enum0&#45;&gt;5 -->
<g id="edge2" class="edge">
<title>5enum0&#45;&gt;5</title>
<path fill="none" stroke="#000000" d="M2078.8902,-491.0164C2086.7975,-575.3815 2102.012,-737.7106 2116.1961,-889.0455"/>
<polygon fill="#000000" stroke="#000000" points="2116.2262,-889.3669 2120.7687,-894.9674 2117.3461,-901.3146 2112.8036,-895.714 2116.2262,-889.3669"/>
</g>
<!-- 6struct0 -->
<g id="node10" class="node">
<title>6struct0</title>
<polygon fill="#f2f2f2" stroke="#000000" points="0,-1149.1 0,-1316.3 126.8114,-1316.3 126.8114,-1149.1 0,-1149.1"/>
<text text-anchor="middle" x="63.4057" y="-1299.7" font-family="Times,serif" font-size="14.00" fill="#000000">&lt;&lt;struct&gt;&gt;</text>
<text text-anchor="middle" x="63.4057" y="-1282.9" font-family="Times,serif" font-size="14.00" fill="#000000">PaymentInput</text>
<polyline fill="none" stroke="#000000" points="0,-1274.7 126.8114,-1274.7 "/>
<text text-anchor="start" x="8" y="-1258.1" font-family="Times,serif" font-size="14.00" fill="#000000">paymentId: bytes32</text>
<text text-anchor="start" x="8" y="-1241.3" font-family="Times,serif" font-size="14.00" fill="#000000">amount: uint256</text>
<text text-anchor="start" x="8" y="-1224.5" font-family="Times,serif" font-size="14.00" fill="#000000">feeBPS: uint256</text>
<text text-anchor="start" x="8" y="-1207.7" font-family="Times,serif" font-size="14.00" fill="#000000">universeId: uint256</text>
<text text-anchor="start" x="8" y="-1190.9" font-family="Times,serif" font-size="14.00" fill="#000000">deadline: uint256</text>
<text text-anchor="start" x="8" y="-1174.1" font-family="Times,serif" font-size="14.00" fill="#000000">buyer: address</text>
<text text-anchor="start" x="8" y="-1157.3" font-family="Times,serif" font-size="14.00" fill="#000000">seller: address</text>
</g>
<!-- 6struct0&#45;&gt;6 -->
<g id="edge3" class="edge">
<title>6struct0&#45;&gt;6</title>
<path fill="none" stroke="#000000" d="M56.8319,-1316.4574C55.8528,-1392.7911 67.9359,-1502.7533 136.4057,-1564.4 185.3587,-1608.4747 630.2061,-1634.8329 801.0268,-1643.4037"/>
<polygon fill="#000000" stroke="#000000" points="801.0993,-1643.4072 807.2902,-1639.7095 813.0846,-1644.0019 806.8937,-1647.6996 801.0993,-1643.4072"/>
</g>
<!-- 6struct1 -->
<g id="node11" class="node">
<title>6struct1</title>
<polygon fill="#f2f2f2" stroke="#000000" points="145.2626,-1191.1 145.2626,-1274.3 275.5488,-1274.3 275.5488,-1191.1 145.2626,-1191.1"/>
<text text-anchor="middle" x="210.4057" y="-1257.7" font-family="Times,serif" font-size="14.00" fill="#000000">&lt;&lt;struct&gt;&gt;</text>
<text text-anchor="middle" x="210.4057" y="-1240.9" font-family="Times,serif" font-size="14.00" fill="#000000">AssetTransferResult</text>
<polyline fill="none" stroke="#000000" points="145.2626,-1232.7 275.5488,-1232.7 "/>
<text text-anchor="start" x="153.2626" y="-1216.1" font-family="Times,serif" font-size="14.00" fill="#000000">paymentId: bytes32</text>
<text text-anchor="start" x="153.2626" y="-1199.3" font-family="Times,serif" font-size="14.00" fill="#000000">wasSuccessful: bool</text>
</g>
<!-- 6struct1&#45;&gt;6 -->
<g id="edge4" class="edge">
<title>6struct1&#45;&gt;6</title>
<path fill="none" stroke="#000000" d="M206.0456,-1274.549C201.2032,-1345.534 202.9115,-1489.1473 284.4057,-1564.4 321.9158,-1599.0373 656.0039,-1629.618 800.8776,-1641.3752"/>
<polygon fill="#000000" stroke="#000000" points="801.0894,-1641.3922 807.391,-1637.8865 813.0507,-1642.3549 806.7492,-1645.8607 801.0894,-1641.3922"/>
</g>
<!-- 7 -->
<g id="node12" class="node">
<title>7</title>
<polygon fill="#f2f2f2" stroke="#000000" points="784.7724,-1103.1 784.7724,-1362.3 1202.039,-1362.3 1202.039,-1103.1 784.7724,-1103.1"/>
<text text-anchor="middle" x="993.4057" y="-1345.7" font-family="Times,serif" font-size="14.00" fill="#000000">Operators</text>
<polyline fill="none" stroke="#000000" points="784.7724,-1337.5 1202.039,-1337.5 "/>
<text text-anchor="start" x="792.7724" y="-1320.9" font-family="Times,serif" font-size="14.00" fill="#000000">Private:</text>
<text text-anchor="start" x="792.7724" y="-1304.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;_defaultOperator: address</text>
<text text-anchor="start" x="792.7724" y="-1287.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;_universeOperators: mapping(uint256=&gt;address)</text>
<polyline fill="none" stroke="#000000" points="784.7724,-1279.1 1202.039,-1279.1 "/>
<text text-anchor="start" x="792.7724" y="-1262.5" font-family="Times,serif" font-size="14.00" fill="#000000">External:</text>
<text text-anchor="start" x="792.7724" y="-1245.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;setDefaultOperator(operator: address)</text>
<text text-anchor="start" x="792.7724" y="-1228.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;setUniverseOperator(universeId: uint256, operator: address)</text>
<text text-anchor="start" x="792.7724" y="-1212.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;removeUniverseOperator(universeId: uint256)</text>
<text text-anchor="start" x="792.7724" y="-1195.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;defaultOperator(): address</text>
<text text-anchor="start" x="792.7724" y="-1178.5" font-family="Times,serif" font-size="14.00" fill="#000000">Public:</text>
<text text-anchor="start" x="792.7724" y="-1161.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; DefaultOperator(operator: address)</text>
<text text-anchor="start" x="792.7724" y="-1144.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; UniverseOperator(universeId: uint256, operator: address)</text>
<text text-anchor="start" x="792.7724" y="-1128.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;constructor()</text>
<text text-anchor="start" x="792.7724" y="-1111.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;universeOperator(universeId: uint256): address</text>
</g>
<!-- 8 -->
<g id="node13" class="node">
<title>8</title>
<polygon fill="#f2f2f2" stroke="#000000" points="693.5827,-.5 693.5827,-864.5 1293.2287,-864.5 1293.2287,-.5 693.5827,-.5"/>
<text text-anchor="middle" x="993.4057" y="-847.9" font-family="Times,serif" font-size="14.00" fill="#000000">PaymentsERC20</text>
<polyline fill="none" stroke="#000000" points="693.5827,-839.7 1293.2287,-839.7 "/>
<text text-anchor="start" x="701.5827" y="-823.1" font-family="Times,serif" font-size="14.00" fill="#000000">Private:</text>
<text text-anchor="start" x="701.5827" y="-806.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;_erc20: address</text>
<text text-anchor="start" x="701.5827" y="-789.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;_eip712: address</text>
<text text-anchor="start" x="701.5827" y="-772.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;_acceptedCurrency: string</text>
<text text-anchor="start" x="701.5827" y="-755.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;_paymentWindow: uint256</text>
<text text-anchor="start" x="701.5827" y="-739.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;_isSellerRegistrationRequired: bool</text>
<text text-anchor="start" x="701.5827" y="-722.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;_isRegisteredSeller: mapping(address=&gt;bool)</text>
<text text-anchor="start" x="701.5827" y="-705.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;_payments: mapping(bytes32=&gt;Payment)</text>
<text text-anchor="start" x="701.5827" y="-688.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;_balanceOf: mapping(address=&gt;uint256)</text>
<polyline fill="none" stroke="#000000" points="693.5827,-680.5 1293.2287,-680.5 "/>
<text text-anchor="start" x="701.5827" y="-663.9" font-family="Times,serif" font-size="14.00" fill="#000000">Private:</text>
<text text-anchor="start" x="701.5827" y="-647.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_processInputPayment(payInput: PaymentInput, operator: address)</text>
<text text-anchor="start" x="701.5827" y="-630.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_refund(paymentId: bytes32)</text>
<text text-anchor="start" x="701.5827" y="-613.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_finalize(transferResult: AssetTransferResult, operatorSignature: bytes)</text>
<text text-anchor="start" x="701.5827" y="-596.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_finalizeSuccess(paymentId: bytes32, payment: Payment)</text>
<text text-anchor="start" x="701.5827" y="-579.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_finalizeFailed(paymentId: bytes32)</text>
<text text-anchor="start" x="701.5827" y="-563.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_refundToLocalBalance(paymentId: bytes32)</text>
<text text-anchor="start" x="701.5827" y="-546.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_withdraw()</text>
<text text-anchor="start" x="701.5827" y="-529.5" font-family="Times,serif" font-size="14.00" fill="#000000">External:</text>
<text text-anchor="start" x="701.5827" y="-512.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;setEIP712(eip712address: address)</text>
<text text-anchor="start" x="701.5827" y="-495.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;setPaymentWindow(window: uint256)</text>
<text text-anchor="start" x="701.5827" y="-479.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;setIsSellerRegistrationRequired(isRequired: bool)</text>
<text text-anchor="start" x="701.5827" y="-462.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;registerAsSeller()</text>
<text text-anchor="start" x="701.5827" y="-445.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;relayedPay(payInput: PaymentInput, buyerSignature: bytes)</text>
<text text-anchor="start" x="701.5827" y="-428.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;pay(payInput: PaymentInput, operatorSignature: bytes)</text>
<text text-anchor="start" x="701.5827" y="-411.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;finalize(transferResult: AssetTransferResult, operatorSignature: bytes)</text>
<text text-anchor="start" x="701.5827" y="-395.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;finalizeAndWithdraw(transferResult: AssetTransferResult, operatorSignature: bytes)</text>
<text text-anchor="start" x="701.5827" y="-378.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;refundAndWithdraw(paymentId: bytes32)</text>
<text text-anchor="start" x="701.5827" y="-361.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;withdraw()</text>
<text text-anchor="start" x="701.5827" y="-344.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;withdrawAmount(amount: uint256)</text>
<text text-anchor="start" x="701.5827" y="-327.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;isSellerRegistrationRequired(): bool</text>
<text text-anchor="start" x="701.5827" y="-311.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;isRegisteredSeller(addr: address): bool</text>
<text text-anchor="start" x="701.5827" y="-294.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;erc20(): address</text>
<text text-anchor="start" x="701.5827" y="-277.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;balanceOf(addr: address): uint256</text>
<text text-anchor="start" x="701.5827" y="-260.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;paymentInfo(paymentId: bytes32): Payment</text>
<text text-anchor="start" x="701.5827" y="-243.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;EIP712Address(): address</text>
<text text-anchor="start" x="701.5827" y="-227.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;paymentWindow(): uint256</text>
<text text-anchor="start" x="701.5827" y="-210.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;acceptedCurrency(): string</text>
<text text-anchor="start" x="701.5827" y="-193.5" font-family="Times,serif" font-size="14.00" fill="#000000">Public:</text>
<text text-anchor="start" x="701.5827" y="-176.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;constructor(erc20Address: address, currencyDescriptor: string, eip712: address)</text>
<text text-anchor="start" x="701.5827" y="-159.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;refund(paymentId: bytes32)</text>
<text text-anchor="start" x="701.5827" y="-143.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;erc20BalanceOf(addr: address): uint256</text>
<text text-anchor="start" x="701.5827" y="-126.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;allowance(buyer: address): uint256</text>
<text text-anchor="start" x="701.5827" y="-109.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;paymentState(paymentId: bytes32): State</text>
<text text-anchor="start" x="701.5827" y="-92.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;acceptsRefunds(paymentId: bytes32): bool</text>
<text text-anchor="start" x="701.5827" y="-75.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;enoughFundsAvailable(buyer: address, amount: uint256): bool</text>
<text text-anchor="start" x="701.5827" y="-59.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;maxFundsAvailable(buyer: address): uint256</text>
<text text-anchor="start" x="701.5827" y="-42.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;splitFundingSources(buyer: address, amount: uint256): (externalFunds: uint256, localFunds: uint256)</text>
<text text-anchor="start" x="701.5827" y="-25.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;checkPaymentInputs(payInput: PaymentInput)</text>
<text text-anchor="start" x="701.5827" y="-8.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;computeFeeAmount(amount: uint256, feeBPS: uint256): uint256</text>
</g>
<!-- 8&#45;&gt;3 -->
<g id="edge9" class="edge">
<title>8&#45;&gt;3</title>
<path fill="none" stroke="#000000" d="M743.4416,-864.5114C699.4655,-940.515 656.3837,-1014.973 620.598,-1076.8212"/>
<polygon fill="none" stroke="#000000" points="611.4055,-1071.7428 605.4693,-1102.9681 629.5821,-1082.26 611.4055,-1071.7428"/>
</g>
<!-- 8&#45;&gt;4 -->
<g id="edge11" class="edge">
<title>8&#45;&gt;4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1280.0816,-864.5114C1356.7251,-980.0107 1431,-1091.9407 1477.1402,-1161.4724"/>
<polygon fill="#000000" stroke="#000000" points="1474.4584,-1163.7611 1482.904,-1170.1582 1480.2911,-1159.8906 1474.4584,-1163.7611"/>
</g>
<!-- 8&#45;&gt;5 -->
<g id="edge8" class="edge">
<title>8&#45;&gt;5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1293.3121,-860.3433C1295.9919,-861.9299 1298.6898,-863.4825 1301.4057,-865 1398.0904,-919.0201 1683.8501,-859.8113 1818.2343,-895.4252"/>
<polygon fill="none" stroke="#000000" points="1814.9375,-905.397 1846.7215,-905.5719 1821.9838,-885.6144 1814.9375,-905.397"/>
</g>
<!-- 8&#45;&gt;7 -->
<g id="edge10" class="edge">
<title>8&#45;&gt;7</title>
<path fill="none" stroke="#000000" d="M993.4057,-864.5114C993.4057,-938.8147 993.4057,-1011.6408 993.4057,-1072.6515"/>
<polygon fill="none" stroke="#000000" points="982.9058,-1072.968 993.4057,-1102.9681 1003.9058,-1072.9681 982.9058,-1072.968"/>
</g>
</g>
</svg>
